---
title: "69意见极化"
author: "mengni chen"
date: "2024-10"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(rvest)
library(tm)
library(jiebaR)
library(ggplot2)
library(reshape2)

```


## 意见极化
定义：
意见极化（Opinion Polarization）是指在社会、政治或文化议题上，不同群体或个体之间的观点和立场差异越来越大，以至于形成了对立的极端观点，难以达成共识的现象。

背景：
意见极化在现代社会中尤为常见，尤其是在社交媒体和互联网的推动下。这种现象在政治选举、社会运动、文化争议等领域中尤为突出。意见极化可能导致社会分裂，影响决策过程，甚至引发冲突。它的重要性在于，它关系到社会的和谐与稳定，以及个体和群体之间的有效沟通。

举例：
例如，在关于气候变化的讨论中，意见极化可能表现为一部分人坚信人类活动是导致气候变化的主要原因，而另一部分人则完全否认这一点。这种极端对立的观点使得双方很难就如何减缓气候变化达成一致。

对比：
意见极化与意见分歧（Disagreement）不同，后者指的是在某个问题上存在不同的看法，但这些看法之间的差异可能并不大，且双方可能愿意通过讨论和协商来寻求共识。而意见极化则涉及到更深层次的价值观和信念，使得双方很难找到共同点。

扩展：
意见极化的成因可能包括信息茧房（Echo Chambers）的形成，即人们倾向于只接触和相信与自己观点一致的信息，从而加强了原有的观点；确认偏误（Confirmation Bias），即人们倾向于寻找和解释信息以证实自己的先入为主的观点；以及群体动力学，如群体极化（Group Polarization），即群体讨论可能加强成员的共同观点，导致更极端的立场。

简明总结：
意见极化是指在某些议题上，不同群体或个体之间的观点差异越来越大，形成对立的极端立场，难以达成共识。这种现象在现代社会中普遍存在，尤其是在社交媒体的影响下。它可能导致社会分裂和冲突，影响决策过程。理解意见极化的背景、成因和表现，有助于我们更好地应对这一社会现象。


```{r cars}

# 提取网页内容
url <- "https://www.wyzxwk.com/Article/shidai/2019/04/402224.html"
web_content <- read_html(url)

# 提取文章内容
articles <- web_content %>% html_nodes("article") %>% html_text()

# 检查是否成功提取到文章内容
if (length(articles) == 0) {
  stop("未能成功提取文章内容，请检查网页链接或结构。")
}

# 读取中文停用词表
stopwords_file <- "D:/1/stopwords.txt"
stopwords_list <- readLines(stopwords_file)
stopwords_list <- unique(stopwords_list)  # 去除重复的停用词

# 转义停用词中的正则表达式特殊字符
# 注意：这里假设你有一个函数来转义正则表达式中的特殊字符
# 如果你的R环境中没有这样的函数，你需要手动转义或者使用其他方法
stopwords_list <- sapply(stopwords_list, function(word) {
  paste0("\\b", gsub("[\\(\\)\\[\\]\\{\\}\\^\\$\\.\\|\\*\\+\\?\\<\\>]", "\\\\\\&", word, perl = TRUE), "\\b")
})

# 使用jiebaR进行中文分词
jieba <- worker(bylines = TRUE)  # 初始化jiebaR的分词器

# 分词并创建新的VCorpus对象
corpus <- lapply(articles, function(text) {
  words <- segment(text, jieba)  # 分词
  return(paste(words, collapse = " "))  # 将分词结果合并为一个字符串
})

# 创建VCorpus对象
corpus <- VCorpus(VectorSource(corpus))

# 文本清洗
corpus <- tm_map(corpus, content_transformer(tolower))
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, removeNumbers)
corpus <- tm_map(corpus, stripWhitespace)

# 去除停用词
corpus <- tm_map(corpus, removeWords, stopwords_list)

# 创建文档-词频矩阵
dtm <- DocumentTermMatrix(corpus)

# 获取词
top_words <- findFreqTerms(dtm, 5)
top_words <- setdiff(top_words, stopwords_list)  # 确保停用词不在top_words中

# 创建文档-词频矩阵  
dtm <- DocumentTermMatrix(corpus)  
 
# 将DocumentTermMatrix转换为数据框，并保留行名作为一列  
dtm_top_df <- as.data.frame(as.matrix(dtm), stringsAsFactors = FALSE)  
print(colnames(dtm_top_df))
row.names(dtm_top_df) <- NULL  # 如果as.data.frame自动将行名设置为第一列，则这一步会删除它  
dtm_top_df$Document <- rownames(dtm)  # 添加Document列，使用原DocumentTermMatrix的行名

# 长格式转换
dtm_top_melt <- melt(dtm_top_df, id.vars = "Document")
colnames(dtm_top_melt)[2] <- "variable"  # 重命名列名以匹配ggplot的aes()

# 关键词分布
ggplot(dtm_top_melt, aes(x = variable, y = value, fill = variable)) +
  geom_bar(stat = "identity") +
  labs(title = "关键词分布", x = "关键词", y = "计数")

# 关键词分布分析
# 转换为数据框
top_words_df <- data.frame(word = names(top_words), freq = top_words)
top_words_df$Document <- seq_along(top_words_df$word)  # 添加Document列
top_words_melted <- melt(top_words_df, id.vars = "Document")
colnames(top_words_melted)[2] <- "variable"  # 关键词分布
ggplot(top_words_melted, aes(x = variable, y = value, fill = variable)) +
  geom_bar(stat = "identity") +
  labs(title = "关键词分布", x = "关键词", y = "频率")

```

